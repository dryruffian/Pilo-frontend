import{j as e}from"./scanner-lib-CQfekM2j.js";import{a as s,u as a,f as l}from"./react-core-DFLHlFU9.js";import{u as r}from"../index-BW18VAUN.js";import{X as t,a as i,H as d,T as n,L as c,b as o,W as m,M as x,c as u,I as h}from"./ui-components-btR2HY2Q.js";import"./state-management-DognVqiI.js";import"./http-client-BCtBl4R5.js";const g=()=>e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-green-50",children:[e.jsxs("div",{className:"p-4 flex justify-between items-center sticky top-0 bg-white/80 backdrop-blur-sm z-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 animate-pulse"}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 animate-pulse"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"p-4 w-full md:w-1/2",children:e.jsx("div",{className:"w-full aspect-square rounded-3xl bg-gray-200 animate-pulse"})}),e.jsxs("div",{className:"p-4 w-full md:w-1/2",children:[e.jsx("div",{className:"h-8 w-3/4 bg-gray-200 rounded-lg animate-pulse mb-2"}),e.jsx("div",{className:"h-4 w-1/2 bg-gray-200 rounded-lg animate-pulse mb-4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 w-24 bg-gray-200 rounded-full animate-pulse"}),e.jsx("div",{className:"h-6 w-24 bg-gray-200 rounded-full animate-pulse"})]})]})]}),e.jsxs("div",{className:"p-4 flex items-center justify-center gap-4",children:[e.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"flex-1 max-w-[200px]",children:[e.jsx("div",{className:"h-6 w-32 bg-gray-200 rounded-lg animate-pulse mb-2"}),e.jsx("div",{className:"h-4 w-48 bg-gray-200 rounded-lg animate-pulse"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 w-40 bg-gray-200 rounded-lg animate-pulse mb-4"}),e.jsx("div",{className:"space-y-3",children:[1,2,3,4].map((s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/50 rounded-xl border border-black/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200 animate-pulse"}),e.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded-lg animate-pulse"})]}),e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200 animate-pulse"})]},s)))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 w-40 bg-gray-200 rounded-lg animate-pulse mb-4"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[1,2,3,4].map((s=>e.jsx("div",{className:"bg-white/50 rounded-xl border border-black/10 p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded-lg animate-pulse"}),e.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded-lg animate-pulse"})]})},s)))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 w-40 bg-gray-200 rounded-lg animate-pulse mb-4"}),e.jsx("div",{className:"space-y-3",children:[1,2,3,4].map((s=>e.jsx("div",{className:"bg-white/50 rounded-xl border border-black/10 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200 animate-pulse"}),e.jsx("div",{className:"h-4 w-24 bg-gray-200 rounded-lg animate-pulse"})]}),e.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded-lg animate-pulse"})]})},s)))})]})]}),j=({value:s,maxValue:a})=>{const l=60,r=100*Math.PI,t=r-s/a*r;return e.jsxs("div",{className:"relative inline-flex items-center justify-center",children:[e.jsxs("svg",{height:120,width:120,className:"transform -rotate-90",children:[e.jsx("circle",{stroke:"#E6E6E6",fill:"transparent",strokeWidth:5,r:50,cx:l,cy:l}),e.jsx("circle",{stroke:"url(#gradient)",fill:"transparent",strokeWidth:5,strokeDasharray:r+" "+r,style:{strokeDashoffset:t},r:50,cx:l,cy:l}),e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#4CAF50"}),e.jsx("stop",{offset:"50%",stopColor:"#FFD700"}),e.jsx("stop",{offset:"100%",stopColor:"#FF4D4D"})]})})]}),e.jsxs("div",{className:"absolute text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:s.toFixed(1)}),e.jsx("div",{className:"text-xs",children:"Score"})]})]})},p=()=>{const[p,b]=s.useState(!0),[N,f]=s.useState(null),[v,w]=s.useState(null),[y,k]=s.useState(!1),C=a(),{barcode:_}=l(),{authenticatedRequest:F}=r();s.useEffect((()=>{_&&(async()=>{var e,s;try{b(!0),f(null);const e=new Promise((e=>setTimeout(e,500))),[s]=await Promise.all([F("get",`/api/v1/barcode/${_}`),e]);s&&"error"!==s.status?w(s):f((null==s?void 0:s.message)||"Failed to fetch product data")}catch(a){f((null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"An error occurred while fetching product data")}finally{b(!1)}})()}),[_,F]);const V=()=>{C(-1)};if(p)return e.jsx(g,{});if(N)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-green-50 flex items-center justify-center",children:e.jsx("div",{className:"text-center p-8 max-w-md",children:e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx(t,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Error Loading Product"}),e.jsx("p",{className:"text-sm text-red-600",children:N}),e.jsx("button",{onClick:V,className:"mt-4 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Go Back"})]})})});if(!v)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-green-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("p",{className:"text-gray-600",children:"No product found for this barcode"}),e.jsx("button",{onClick:V,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Go Back"})]})});const{product_name:S="Unknown Product",brands:A="Unknown Brand",image_url:D,food_score:E=0,food_restriction:G={},nutrition_values:L={},nutrition_advisor:O="",allergens:$=[],nutriscore_grade:z,nova_group:P,ingredients_text:q}=v||{},I=Object.entries(L).reduce(((e,[s,a])=>{const l="object"==typeof a?a.value||0:a;return isNaN(l)||(e[s]=l),e}),{}),W={isVegan:(null==G?void 0:G.isVegan)||!1,isVegetarian:(null==G?void 0:G.isVegetarian)||!1,isGlutenFree:!(null==$?void 0:$.includes("gluten")),isLactoseFree:!(null==$?void 0:$.includes("milk"))};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-yellow-50 to-green-50",children:[e.jsxs("div",{className:"p-4 flex justify-between items-center sticky top-0 bg-white/80 backdrop-blur-sm z-10",children:[e.jsx("button",{onClick:V,className:"p-2 hover:bg-black/5 rounded-full",children:e.jsx(t,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:async()=>{try{await navigator.share({title:v.product_name,text:`Check out this product: ${v.product_name}`,url:window.location.href})}catch(e){}},className:"p-2 hover:bg-black/5 rounded-full",children:e.jsx(i,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>{k(!y)},className:"p-2 hover:bg-black/5 rounded-full",children:e.jsx(d,{className:"w-6 h-6 "+(y?"fill-red-500 text-red-500":"")})})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"p-4 w-full md:w-1/2",children:e.jsx("img",{src:D,className:"w-full aspect-square rounded-3xl shadow-sm object-cover",alt:S,onError:e=>{e.target.onerror=null,e.target.src="/api/placeholder/400/400"}})}),e.jsxs("div",{className:"p-4 w-full md:w-1/2",children:[e.jsx("h1",{className:"text-2xl font-bold",children:S}),e.jsx("p",{className:"text-gray-600",children:A}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[z&&e.jsxs("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["Nutri-Score: ",z.toUpperCase()]}),P&&e.jsxs("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["NOVA Group: ",P]})]})]})]}),e.jsxs("div",{className:"p-4 flex items-center justify-center gap-4",children:[e.jsx(j,{value:E,maxValue:10}),e.jsxs("div",{className:"text-left",children:[e.jsx("h2",{className:"font-bold",children:"FoodCheck Score"}),e.jsx("p",{className:"text-sm text-gray-600",children:"This score helps you to estimate the product quality"})]})]}),$.length>0&&e.jsxs("div",{className:"mx-4 p-4 bg-red-50 rounded-xl border border-red-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5 text-red-600"}),e.jsx("h3",{className:"text-red-800 font-medium",children:"Allergen Warning"})]}),e.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["Contains: ",$.join(", ")]})]}),q&&e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"font-bold mb-2",children:"Ingredients"}),e.jsx("div",{className:"bg-white/50 rounded-xl border border-black/10 p-4",children:e.jsx("p",{className:"text-sm text-gray-700",children:q})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"font-bold mb-4",children:"Dietary Information"}),e.jsx("div",{className:"space-y-3",children:Object.entries(W).map((([s,a])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/50 rounded-xl border border-black/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:["isVegan"===s&&e.jsx(c,{className:"w-5 h-5 text-green-600"}),"isVegetarian"===s&&e.jsx(o,{className:"w-5 h-5 text-green-600"}),"isGlutenFree"===s&&e.jsx(m,{className:"w-5 h-5 text-green-600"}),"isLactoseFree"===s&&e.jsx(x,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{children:s.replace("is","").replace(/([A-Z])/g," $1").trim()})]}),a?e.jsx(u,{className:"w-5 h-5 text-green-600"}):e.jsx(t,{className:"w-5 h-5 text-red-500"})]},s)))})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"font-bold mb-4",children:"Nutrition Values"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(I).map((([s,a])=>{const l="energy"===s.toLowerCase()?"kcal":"g";return e.jsx("div",{className:"bg-white/50 rounded-xl border border-black/10 p-3",children:e.jsxs("div",{className:"flex justify-between items-center ",children:[e.jsx("span",{className:"capitalize font-medium",children:s.replace(/_/g," ")}),e.jsxs("span",{className:"font-bold",children:[a," ",l]})]})},s)}))})]}),O&&"object"==typeof O&&Object.keys(O).length>0&&e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"font-bold mb-4",children:"Nutrition Analysis"}),e.jsx("div",{className:"space-y-3",children:Object.entries(O).map((([s,a])=>{let l="bg-yellow-50",r="text-yellow-700";switch(a.toLowerCase()){case"low":l="bg-green-50",r="text-green-700";break;case"medium":case"moderate":l="bg-yellow-50",r="text-yellow-700";break;case"high":l="bg-red-50",r="text-red-700";break;default:l="bg-gray-50",r="text-gray-700"}return e.jsx("div",{className:`${l} rounded-xl border border-black/10 p-4`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:`w-5 h-5 ${r}`}),e.jsx("span",{className:"font-medium capitalize",children:s.replace(/_/g," ")})]}),e.jsx("span",{className:`${r} font-medium capitalize`,children:a})]})},s)}))})]})]})};export{p as default};
